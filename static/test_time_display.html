<!DOCTYPE html>
<html>
<head>
    <title>Test Time Display Fix</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #732C3F; color: white; }
        .test-row { background: #f9f9f9; }
        h1 { color: #732C3F; }
    </style>
</head>
<body>
    <h1>Time Display Fix Test</h1>
    
    <h2>Test Data from API:</h2>
    <table>
        <tr>
            <th>Bill Number</th>
            <th>Raw Timestamp</th>
            <th>Formatted Display</th>
            <th>Expected</th>
        </tr>
        <tr class="test-row">
            <td>BILL-20260112-00cfc7c4</td>
            <td>2026-01-12 10:40:20</td>
            <td id="time1">Loading...</td>
            <td>12 Jan 2026<br><small>10:40 AM</small></td>
        </tr>
        <tr class="test-row">
            <td>BILL-20260112-24a90c3b</td>
            <td>2026-01-12 01:18:44</td>
            <td id="time2">Loading...</td>
            <td>12 Jan 2026<br><small>01:18 AM</small></td>
        </tr>
        <tr class="test-row">
            <td>BILL-20260112-edadb020</td>
            <td>2026-01-12 01:08:10</td>
            <td id="time3">Loading...</td>
            <td>12 Jan 2026<br><small>01:08 AM</small></td>
        </tr>
        <tr class="test-row">
            <td>BILL-20260112-9370d0e7</td>
            <td>2026-01-12 00:59:59</td>
            <td id="time4">Loading...</td>
            <td>12 Jan 2026<br><small>12:59 AM</small></td>
        </tr>
    </table>

    <script>
        // FIXED formatDate function (same as in sales_management_wine.html)
        function formatDate(dateStr) {
            if (!dateStr) return 'N/A';
            try {
                // Parse the timestamp as local time, not UTC
                // Format: "2026-01-12 00:59:59" or "2026-01-12"
                const parts = dateStr.split(' ');
                const dateParts = parts[0].split('-');
                
                const year = parseInt(dateParts[0]);
                const month = parseInt(dateParts[1]) - 1; // Month is 0-indexed
                const day = parseInt(dateParts[2]);
                
                let hour = 0, minute = 0, second = 0;
                if (parts.length > 1) {
                    const timeParts = parts[1].split(':');
                    hour = parseInt(timeParts[0]) || 0;
                    minute = parseInt(timeParts[1]) || 0;
                    second = parseInt(timeParts[2]) || 0;
                }
                
                // Create date with explicit local time components
                const date = new Date(year, month, day, hour, minute, second);
                
                const dateFormatted = date.toLocaleDateString('en-IN', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                const timeFormatted = date.toLocaleTimeString('en-IN', {
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: true
                });
                return `${dateFormatted}<br><small style="color: #6b7280; font-size: 0.75rem;">${timeFormatted}</small>`;
            } catch (e) {
                return dateStr;
            }
        }

        // Test timestamps from the API
        const testTimestamps = [
            '2026-01-12 10:40:20',
            '2026-01-12 01:18:44',
            '2026-01-12 01:08:10',
            '2026-01-12 00:59:59'
        ];

        // Display results
        testTimestamps.forEach((ts, i) => {
            const num = i + 1;
            document.getElementById('time' + num).innerHTML = formatDate(ts);
        });
    </script>
</body>
</html>