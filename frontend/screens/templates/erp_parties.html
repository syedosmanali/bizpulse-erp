{% extends "erp_base_layout.html" %}
{% block title %}Parties - ERP{% endblock %}
{% block extra_css %}
<style>
:root{--wine:#732C3F;--bg:#fff;--text:#1A1A1A;--sub:#6B7280;--border:#e5e7eb}
body{background:var(--bg);font-family:system-ui,-apple-system,sans-serif}
.container{max-width:1400px;margin:0 auto;padding:20px}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
.header h1{font-size:24px;font-weight:700;color:var(--text);display:flex;align-items:center;gap:10px;margin:0}
.tabs{display:flex;gap:8px;border-bottom:2px solid var(--border);margin-bottom:24px}
.tab{padding:12px 24px;cursor:pointer;border:none;background:none;font-size:14px;font-weight:600;color:var(--sub);border-bottom:3px solid transparent;transition:all .2s}
.tab.active{color:var(--wine);border-bottom-color:var(--wine)}
.tab:hover{color:var(--wine)}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:24px}
.stat-card{background:#fff;border:1.5px solid var(--border);border-radius:10px;padding:20px;border-left:4px solid var(--wine)}
.stat-card h3{font-size:12px;color:var(--sub);margin:0 0 8px;text-transform:uppercase;letter-spacing:.5px}
.stat-card .value{font-size:28px;font-weight:700;color:var(--wine);margin:0}
.card{background:#fff;border:1.5px solid var(--border);border-radius:10px;padding:20px;margin-bottom:20px}
.card-title{font-size:16px;font-weight:600;color:var(--text);margin-bottom:16px;display:flex;align-items:center;gap:8px}
.btn{border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;padding:10px 20px;display:inline-flex;align-items:center;gap:8px;transition:all .2s}
.btn-primary{background:var(--wine);color:#fff}
.btn-primary:hover{background:#8d3a4f}
.btn-secondary{background:#f3f4f6;color:var(--text)}
.btn-secondary:hover{background:#e5e7eb}
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:13px;font-weight:600;color:var(--text);margin-bottom:6px}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:10px 12px;border:1.5px solid var(--border);border-radius:8px;font-size:14px}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{outline:none;border-color:var(--wine);box-shadow:0 0 0 3px rgba(115,44,63,.1)}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.search-box{position:relative;margin-bottom:16px}
.search-box input{padding-left:40px}
.search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--sub)}
.list-item{background:#f8fafc;border:1.5px solid var(--border);border-radius:8px;padding:16px;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center;transition:all .2s}
.list-item:hover{border-color:var(--wine);background:#fff;box-shadow:0 4px 12px rgba(115,44,63,.1)}
.list-item h3{font-size:16px;font-weight:600;margin:0 0 4px;color:var(--text)}
.list-item p{font-size:13px;color:var(--sub);margin:2px 0}
.badge{display:inline-block;padding:4px 8px;border-radius:4px;font-size:11px;font-weight:600;text-transform:uppercase}
.badge-active{background:#d1fae5;color:#065f46}
.badge-inactive{background:#f3f4f6;color:#6b7280}
.badge-prospect{background:#fef3c7;color:#d97706}
.actions{display:flex;gap:8px}
.hidden{display:none}
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#1a1a1a;color:#fff;padding:12px 20px;border-radius:20px;font-size:13px;z-index:9999;opacity:0;transition:opacity .3s;pointer-events:none}
.toast.show{opacity:1;pointer-events:auto}
.toast.success{background:#059669}
.toast.error{background:#dc2626}
@media(max-width:768px){.form-row{grid-template-columns:1fr}.stats{grid-template-columns:repeat(2,1fr)}.list-item{flex-direction:column;align-items:flex-start;gap:12px}.actions{width:100%;justify-content:flex-end}}
</style>
{% endblock %}
{% block content %}
<div class="container">
<div class="header">
<h1><i data-lucide="users"></i>Parties Management</h1>
<button class="btn btn-primary" onclick="showForm()"><i data-lucide="plus"></i>Add New</button>
</div>
<div class="tabs">
<button class="tab active" data-view="dashboard" onclick="switchView('dashboard')">Dashboard</button>
<button class="tab" data-view="customers" onclick="switchView('customers')">Customers</button>
<button class="tab" data-view="vendors" onclick="switchView('vendors')">Vendors</button>
<button class="tab" data-view="crm" onclick="switchView('crm')">CRM Leads</button>
</div>
<div id="dashboard-view">
<div class="stats">
<div class="stat-card"><h3>Customers</h3><div class="value" id="totalCustomers">156</div></div>
<div class="stat-card"><h3>Vendors</h3><div class="value" id="totalVendors">42</div></div>
<div class="stat-card"><h3>CRM Leads</h3><div class="value" id="totalLeads">28</div></div>
<div class="stat-card"><h3>Outstanding</h3><div class="value">‚Çπ2.4L</div></div>
</div>
<div class="card">
<div class="card-title"><i data-lucide="activity"></i>Quick Actions</div>
<div style="display:flex;gap:12px;flex-wrap:wrap">
<button class="btn btn-secondary" onclick="switchView('customers')"><i data-lucide="user-plus"></i>Add Customer</button>
<button class="btn btn-secondary" onclick="switchView('vendors')"><i data-lucide="store"></i>Add Vendor</button>
<button class="btn btn-secondary" onclick="switchView('crm')"><i data-lucide="target"></i>Add Lead</button>
</div>
</div>
</div>
<div id="customers-view" class="hidden">
<div class="stats">
<div class="stat-card"><h3>Total</h3><div class="value">156</div></div>
<div class="stat-card"><h3>Active</h3><div class="value">124</div></div>
<div class="stat-card"><h3>Prospects</h3><div class="value">25</div></div>
<div class="stat-card"><h3>Outstanding</h3><div class="value">‚Çπ1.2L</div></div>
</div>
<div class="card" id="customerForm" style="display:none">
<div class="card-title"><i data-lucide="user-plus"></i>Add Customer</div>
<div class="form-row">
<div class="form-group"><label>Name *</label><input id="cust_name" placeholder="Customer name"></div>
<div class="form-group"><label>Phone *</label><input id="cust_phone" placeholder="9876543210"></div>
</div>
<div class="form-row">
<div class="form-group"><label>Email</label><input id="cust_email" placeholder="email@example.com"></div>
<div class="form-group"><label>Type</label><select id="cust_type"><option>Retail</option><option>Wholesale</option><option>Corporate</option></select></div>
</div>
<div class="form-group"><label>Address</label><textarea id="cust_address" rows="2"></textarea></div>
<div style="display:flex;gap:12px">
<button class="btn btn-primary" onclick="saveCustomer()"><i data-lucide="save"></i>Save</button>
<button class="btn btn-secondary" onclick="hideForm()">Cancel</button>
</div>
</div>
<div class="card">
<div class="card-title"><i data-lucide="search"></i>Search</div>
<div class="search-box"><span class="search-icon"><i data-lucide="search"></i></span><input id="custSearch" placeholder="Search customers..." onkeyup="filterList('customers')"></div>
</div>
<div class="card">
<div class="card-title"><i data-lucide="users"></i>Customers (<span id="custCount">0</span>)</div>
<div id="customerList"></div>
</div>
</div>
<div id="vendors-view" class="hidden">
<div class="stats">
<div class="stat-card"><h3>Total</h3><div class="value">42</div></div>
<div class="stat-card"><h3>Active</h3><div class="value">38</div></div>
<div class="stat-card"><h3>Pending</h3><div class="value">4</div></div>
<div class="stat-card"><h3>Payables</h3><div class="value">‚Çπ3.4L</div></div>
</div>
<div class="card" id="vendorForm" style="display:none">
<div class="card-title"><i data-lucide="store"></i>Add Vendor</div>
<div class="form-row">
<div class="form-group"><label>Name *</label><input id="vend_name" placeholder="Vendor name"></div>
<div class="form-group"><label>Contact Person</label><input id="vend_contact" placeholder="Contact name"></div>
</div>
<div class="form-row">
<div class="form-group"><label>Phone *</label><input id="vend_phone" placeholder="9876543210"></div>
<div class="form-group"><label>Email</label><input id="vend_email" placeholder="email@example.com"></div>
</div>
<div class="form-group"><label>Address</label><textarea id="vend_address" rows="2"></textarea></div>
<div style="display:flex;gap:12px">
<button class="btn btn-primary" onclick="saveVendor()"><i data-lucide="save"></i>Save</button>
<button class="btn btn-secondary" onclick="hideForm()">Cancel</button>
</div>
</div>
<div class="card">
<div class="card-title"><i data-lucide="search"></i>Search</div>
<div class="search-box"><span class="search-icon"><i data-lucide="search"></i></span><input id="vendSearch" placeholder="Search vendors..." onkeyup="filterList('vendors')"></div>
</div>
<div class="card">
<div class="card-title"><i data-lucide="building-2"></i>Vendors (<span id="vendCount">0</span>)</div>
<div id="vendorList"></div>
</div>
</div>
<div id="crm-view" class="hidden">
<div class="stats">
<div class="stat-card"><h3>Total Leads</h3><div class="value">28</div></div>
<div class="stat-card"><h3>Hot</h3><div class="value">8</div></div>
<div class="stat-card"><h3>Warm</h3><div class="value">12</div></div>
<div class="stat-card"><h3>Cold</h3><div class="value">8</div></div>
</div>
<div class="card" id="leadForm" style="display:none">
<div class="card-title"><i data-lucide="target"></i>Add Lead</div>
<div class="form-row">
<div class="form-group"><label>Name *</label><input id="lead_name" placeholder="Lead name"></div>
<div class="form-group"><label>Phone *</label><input id="lead_phone" placeholder="9876543210"></div>
</div>
<div class="form-row">
<div class="form-group"><label>Email</label><input id="lead_email" placeholder="email@example.com"></div>
<div class="form-group"><label>Status</label><select id="lead_status"><option>Hot</option><option>Warm</option><option>Cold</option></select></div>
</div>
<div class="form-group"><label>Notes</label><textarea id="lead_notes" rows="2"></textarea></div>
<div style="display:flex;gap:12px">
<button class="btn btn-primary" onclick="saveLead()"><i data-lucide="save"></i>Save</button>
<button class="btn btn-secondary" onclick="hideForm()">Cancel</button>
</div>
</div>
<div class="card">
<div class="card-title"><i data-lucide="search"></i>Search</div>
<div class="search-box"><span class="search-icon"><i data-lucide="search"></i></span><input id="leadSearch" placeholder="Search leads..." onkeyup="filterList('crm')"></div>
</div>
<div class="card">
<div class="card-title"><i data-lucide="users-round"></i>Leads (<span id="leadCount">0</span>)</div>
<div id="leadList"></div>
</div>
</div>
</div>
<div id="toast" class="toast"></div>
<script>
let currentView='dashboard';
const customers=[{id:1,name:'Rajesh Kumar',phone:'9876543210',email:'rajesh@ex.com',type:'Retail',status:'active'},{id:2,name:'Priya Sharma',phone:'9876543211',email:'priya@ex.com',type:'Wholesale',status:'active'}];
const vendors=[{id:1,name:'Tech Solutions',contact:'Amit',phone:'9876543210',email:'amit@tech.com',status:'active'},{id:2,name:'Global Supplies',contact:'Sarah',phone:'9876543211',email:'sarah@global.com',status:'active'}];
const leads=[{id:1,name:'John Doe',phone:'9876543210',email:'john@ex.com',status:'Hot'},{id:2,name:'Jane Smith',phone:'9876543211',email:'jane@ex.com',status:'Warm'}];
function switchView(view){currentView=view;document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.querySelector(`[data-view="${view}"]`).classList.add('active');['dashboard','customers','vendors','crm'].forEach(v=>document.getElementById(`${v}-view`).classList.add('hidden'));document.getElementById(`${view}-view`).classList.remove('hidden');hideForm();if(view==='customers')renderCustomers();if(view==='vendors')renderVendors();if(view==='crm')renderLeads();lucide.createIcons()}
function showForm(){if(currentView==='customers')document.getElementById('customerForm').style.display='block';if(currentView==='vendors')document.getElementById('vendorForm').style.display='block';if(currentView==='crm')document.getElementById('leadForm').style.display='block'}
function hideForm(){document.getElementById('customerForm').style.display='none';document.getElementById('vendorForm').style.display='none';document.getElementById('leadForm').style.display='none'}
function showToast(msg,type='success'){const t=document.getElementById('toast');t.textContent=msg;t.className=`toast ${type} show`;setTimeout(()=>t.classList.remove('show'),3000)}
function renderCustomers(){const el=document.getElementById('customerList');document.getElementById('custCount').textContent=customers.length;el.innerHTML=customers.map(c=>`<div class="list-item"><div><h3>${c.name}</h3><p>üìû ${c.phone} | ‚úâÔ∏è ${c.email}</p><p><span class="badge badge-${c.status}">${c.status}</span> <span class="badge">${c.type}</span></p></div><div class="actions"><button class="btn btn-secondary" onclick="editCustomer(${c.id})"><i data-lucide="edit"></i></button><button class="btn btn-secondary" onclick="deleteCustomer(${c.id})"><i data-lucide="trash-2"></i></button></div></div>`).join('');lucide.createIcons()}
function renderVendors(){const el=document.getElementById('vendorList');document.getElementById('vendCount').textContent=vendors.length;el.innerHTML=vendors.map(v=>`<div class="list-item"><div><h3>${v.name}</h3><p>Contact: ${v.contact}</p><p>üìû ${v.phone} | ‚úâÔ∏è ${v.email}</p><p><span class="badge badge-${v.status}">${v.status}</span></p></div><div class="actions"><button class="btn btn-secondary" onclick="editVendor(${v.id})"><i data-lucide="edit"></i></button><button class="btn btn-secondary" onclick="deleteVendor(${v.id})"><i data-lucide="trash-2"></i></button></div></div>`).join('');lucide.createIcons()}
function renderLeads(){const el=document.getElementById('leadList');document.getElementById('leadCount').textContent=leads.length;el.innerHTML=leads.map(l=>`<div class="list-item"><div><h3>${l.name}</h3><p>üìû ${l.phone} | ‚úâÔ∏è ${l.email}</p><p><span class="badge badge-${l.status.toLowerCase()}">${l.status}</span></p></div><div class="actions"><button class="btn btn-secondary" onclick="editLead(${l.id})"><i data-lucide="edit"></i></button><button class="btn btn-secondary" onclick="deleteLead(${l.id})"><i data-lucide="trash-2"></i></button></div></div>`).join('');lucide.createIcons()}
function saveCustomer(){const name=document.getElementById('cust_name').value;if(!name){showToast('Name required','error');return}showToast('Customer saved');hideForm();renderCustomers()}
function saveVendor(){const name=document.getElementById('vend_name').value;if(!name){showToast('Name required','error');return}showToast('Vendor saved');hideForm();renderVendors()}
function saveLead(){const name=document.getElementById('lead_name').value;if(!name){showToast('Name required','error');return}showToast('Lead saved');hideForm();renderLeads()}
function editCustomer(id){showToast('Edit customer '+id)}
function deleteCustomer(id){if(confirm('Delete?')){showToast('Customer deleted');renderCustomers()}}
function editVendor(id){showToast('Edit vendor '+id)}
function deleteVendor(id){if(confirm('Delete?')){showToast('Vendor deleted');renderVendors()}}
function editLead(id){showToast('Edit lead '+id)}
function deleteLead(id){if(confirm('Delete?')){showToast('Lead deleted');renderLeads()}}
function filterList(type){}
document.addEventListener('DOMContentLoaded',()=>{const view='{{ view|default("dashboard") }}';if(view!=='dashboard')switchView(view);lucide.createIcons()});
</script>
{% endblock %}
